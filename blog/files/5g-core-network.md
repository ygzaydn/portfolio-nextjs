# Understanding the 5G Core (5GC) Network Functions (3GPP)

- [Understanding the 5G Core (5GC) Network Functions (3GPP)](#understanding-the-5g-core-5gc-network-functions-3gpp)
  - [Access and Mobility Management Function (AMF)](#access-and-mobility-management-function-amf)
  - [Session Management Function (SMF)](#session-management-function-smf)
  - [User Plane Function (UPF)](#user-plane-function-upf)
  - [Unified Data Management (UDM)](#unified-data-management-udm)
  - [Authentication Server Function (AUSF)](#authentication-server-function-ausf)
  - [Policy Control Function (PCF)](#policy-control-function-pcf)
  - [Network Slice Selection Function (NSSF)](#network-slice-selection-function-nssf)
  - [NF Repository Function (NRF)](#nf-repository-function-nrf)
  - [Network Exposure Function (NEF)](#network-exposure-function-nef)
  - [Application Function (AF)](#application-function-af)

The 5G Core (5GC) is the heart of the 5G network, defined by 3GPP in Release 15+ to replace the 4G Evolved Packet Core (EPC). It introduces a **Service-Based Architecture (SBA)**, where each network function offers services via open APIs rather than fixed point-to-point interfaces. This cloud-native design enables flexibility, scalability, and support for new features like network slicing and edge computing. Telecom professionals familiar with EPC will find that many core functions in 5G correspond to roles that existed in 4G, albeit re-architected and split for better modularity and control-plane/user-plane separation (CUPS).

![img.jpeg](https://www.telecomhall.net/uploads/db2683/original/3X/f/a/faae8687f5f9c9e093c1814b9ae0ccd51f5cf769.jpeg)

_Mapping of 4G EPC network entities to 5G Core functions. Many 5GC functions are evolved from 4G components. For instance, the MME’s responsibilities are now handled by the 5G **AMF** (for access and mobility management) and partly by the **SMF** (for session management), while the HSS’s subscriber management roles are taken up by **UDM** (data management) and **AUSF** (authentication). The serving and PDN gateways in 4G (SGW/PGW) are replaced by the unified **UPF** for user-plane data forwarding, and the PCRF’s policy control logic is provided by the **PCF**. Completely new functions like **NRF**, **NSSF**, and **NEF** have been introduced in 5G to enable service discovery, network slicing, and secure API exposure, which had no direct equivalents in the EPC._

Below, we describe each major 5G Core Network Function (NF) – **AMF, SMF, UPF, PCF, UDM, AUSF, NSSF, NRF, NEF,** and **AF** – detailing their core functionality and how they interact with other elements in the 5GC architecture (as per 3GPP standards).

## Access and Mobility Management Function (AMF)

The **AMF** is the control-plane node that manages **access** and **mobility** for UEs (User Equipment) in 5G. It is the first contact point in the core for a device connecting via the RAN (gNB), terminating the NAS signaling from the UE. Key responsibilities of the AMF include:

- **Registration & connection management:** Handling initial registrations, managing UE reachability, and establishing or releasing the NAS connection with the UE. It processes attachment and detachment, similar to how the MME functioned in 4G.
- **Mobility management:** Keeping track of the UE’s location and status, managing handovers between gNBs or tracking area updates as the UE moves. The AMF maintains the UE’s mobility context and ensures seamless transitions between cells or coverage areas.
- **Access authentication & authorization:** Initiating and orchestrating the authentication of UEs by interacting with the **AUSF** (for AKA security challenge) and retrieving subscriber data from **UDM**. It ensures the device is allowed to access the network and specific services (including slice access permissions).
- **Network slice allocation:** Helping select the appropriate network slice for the UE’s sessions by interfacing with the **NSSF**. During registration, the AMF obtains the Allowed NSSAI (Network Slice list) from UDM and uses NSSF to assign the UE to the correct slice(s) based on subscription and request.

_Interactions:_ The AMF is a central signaling hub that connects to many other NFs. It communicates with the RAN (gNB) over the N2 interface and with the UE over N1 (NAS) to carry all non-access signaling. For authentication, it invokes the **AUSF** (N12 interface) and fetches subscription profiles from **UDM** (N8). The AMF also queries the **NSSF** (N22) when a UE requests a specific slice or during initial registration to get slice selection assistance. Additionally, the AMF exposes services (Namf) that other NFs or applications (e.g. **PCF**, **NEF**, **AF**) can use to subscribe to UE events or status changes. In summary, the AMF focuses on signaling and control – it has no user data traffic passing through it and remains agnostic to the access type (it can support 3GPP or non-3GPP access in a unified way). (In legacy terms, the AMF takes over the mobility and connection management parts of the 4G MME.)

## Session Management Function (SMF)

The **SMF** is the control-plane function responsible for **session management** and the allocation of resources for PDU (Packet Data Unit) sessions. In simple terms, it handles everything to do with establishing, maintaining, and tearing down the UE’s data sessions (the 5G equivalent of PDP contexts or bearers). Key functions of the SMF include:

- **PDU session lifecycle management:** Creating, modifying, and releasing PDU sessions which provide the UE with connectivity to a Data Network (DN). Upon a UE’s request (forwarded by AMF), the SMF allocates a new session, sets up the necessary user-plane paths, or tears it down when no longer needed.
- **UPF selection and control:** Choosing the appropriate **User Plane Function (UPF)** to handle the data traffic for a session, and sending it instructions over the N4 interface. The SMF acts like the “brain” of the user plane, programming the UPF with traffic steering rules, forwarding parameters, and mapping of QoS flows to tunnels. It can also select different UPF instances based on network topology, edge location, or network slicing requirements.
- **IP address allocation & DHCP functions:** Assigning IP addresses (or IPv6 prefixes, or other network identifiers) to the UE for its sessions. The SMF can act as or interface with an IP Address Management system, similar to how the PGW control-plane functioned as a DHCP server in 4G.
- **Policy and QoS enforcement (control-plane side):** Enforcing policy decisions by acquiring session and QoS rules from the **PCF** and applying them to the session context. For example, if the PCF mandates a certain QoS profile or data rate limit for the subscriber, the SMF will install those rules in the UPF (and provide QoS info to the RAN via the AMF). It also ensures charging triggers are applied, interacting with the Charging Function (CHF) for usage accounting if deployed.
- **Interworking and roaming support:** If the network is in a Non-Standalone or interworking scenario with 4G, the SMF handles interoperability (for instance, coordinating with a 4G EPC’s SGW/PGW in an anchoring role). In roaming cases, a visited-network SMF might collaborate with the home network’s SMF/UPF for session breakout or steering, as per roaming agreements.

_Interactions:_ The SMF receives session setup requests from the **AMF** (N11 interface) and, if the AMF hasn’t already chosen one, the SMF may query the **NRF** to discover other NFs (like finding a suitable UPF or PCF). It sends control commands to the **UPF** over N4 using the PFCP protocol (Packet Forwarding Control Protocol). During session establishment and updates, the SMF consults the **PCF** over N7 to obtain policy rules (QoS profiles, gating rules, charging parameters) applicable to that session. It may also retrieve subscriber session data (e.g. allowed services, roaming restrictions, or APN/DNN info) from the **UDM** over N10. In the context of network slicing, the SMF relies on slice selection decisions: the AMF (with NSSF’s input) will ensure the SMF chosen is appropriate for the requested slice. The SMF also interacts with **AFs** or **NEF** indirectly – for instance, if an application requests a certain traffic routing or forwarding policy (via PCF/NEF), the SMF implements those by configuring the UPF accordingly. In 4G terms, the SMF’s role is analogous to parts of the MME plus the control-plane of SGW/PGW (handling bearer setup, TEIDs, IP allocation, etc.). It is designed to be access-agnostic and modular, so the same SMF can manage sessions for 3GPP access or non-3GPP (Wi-Fi) through a common core framework.

## User Plane Function (UPF)

The **UPF** is the primary **user-plane** element in the 5G Core, responsible for forwarding user data packets between the RAN and the external Data Network. It’s a **pure data-plane** function (no signaling with the UE directly) and can be thought of as the 5G evolution of the packet gateways (SGW-U/PGW-U) combined into one Core functions of the UPF include:

- **Packet routing and forwarding:** Receiving encapsulated traffic from the gNB (via N3 interface) and forwarding it to the appropriate external network (and vice versa. It decapsulates GTP-U packets from the RAN, routes IP (or Ethernet) packets toward the correct data network (internet, IMS, enterprise network, etc.), and handles the return path. The UPF is the anchor point for the PDU session, maintaining the mapping between the UE’s session and the underlay transport network.
- **QoS enforcement and traffic handling:** Enforcing Quality of Service rules and other policies at the packet level. The UPF applies filters, rate limits, priority handling, and shaping as instructed by the SMF/PCF (for example, ensuring a video stream gets a guaranteed bit rate or blocking unauthorized traffic). It can perform deep packet inspection for applications that require it and mark packets with QoS identifiers.
- **Policy and usage reporting:** Acting as the enforcement point for data usage policies and gathering traffic statistics. The UPF generates usage reports (e.g., volume of data, duration of flows) which can be sent to a Charging Function (CHF) for billing or to analytics functions (like NWDAF) for insight. This is analogous to the PDN-GW’s role in 4G that produced charging data records.
- **Mobility anchoring:** Serving as the anchor for mobility, meaning that as a UE moves and possibly changes its serving gNB or even between radio technologies, the UPF can remain the stable gateway for the session. For intra-5G handovers, the UPF may also handle path switching (or there could be intermediate UPFs). It can also anchor inter-RAT mobility (for instance, between 5G and LTE) if needed.
- **Local breakout and edge computing support:** UPFs can be deployed in a distributed fashion (e.g., at the network edge or on-premises) to offload traffic and reduce latency. A UPF located near the user might route certain traffic (say, to a local CDN or edge cloud) without having to traverse the entire core network, enabling **MEC (Multi-access Edge Computing)** use cases.

_Interactions:_ The UPF is controlled by the **SMF** over the N4 interface. The SMF instructs the UPF on how to treat each PDU session’s traffic: what outer tunnel to use for a given UE (N3 GTP-U tunnel ID), what QoS handling to apply for each QoS flow, how to route to specific DNs, etc. The UPF has an N3 interface from the RAN (gNB) and an N6 interface toward the Data Network (e.g. the internet). In some scenarios, multiple UPFs may be chained (for example, a local UPF at the edge and a central UPF), communicating via N9 interfaces (UPF-to-UPF) to allow flexible traffic breakout. The UPF itself doesn’t signal directly with control-plane NFs like AMF/UDM/PCF, but it enforces the rules they set. It may send usage reports back to the SMF (which then relays them to PCF/CHF). In summary, the UPF is the **data plane workhorse** of the 5G Core, analogous to the combined SGW-U + PGW-U in EPC, and it can scale and be distributed independently of the control functions.

## Unified Data Management (UDM)

The **UDM** is the logical descendant of the 4G HSS (Home Subscriber Server). It is a centralized function for managing **subscriber data and profiles** in the 5G Core. The UDM is part of 3GPP’s common data layer approach, often paired with a **UDR (Unified Data Repository)** which actually stores the data that UDM retrieves and manages. Core responsibilities of the UDM include:

- **Subscriber data storage and management:** Acting as the front-end for retrieving and updating subscriber information such as subscription tiers, allowed services, roaming permissions, and network slice access profiles. It holds the **subscriber profile** which might include which slices the subscriber can use, what QoS or data plans they have, and any service-specific entitlements. (The actual data may reside in a UDR database, which the UDM queries)
- **Authentication data handling:** Generating and storing authentication credentials and vectors. When a UE registers, UDM (in conjunction with an authentication center function) provides the **AUSF** with the necessary authentication info (e.g., the MILENAGE or 5G AKA parameters based on the SIM’s key). It essentially performs the role of the HSS’s Authentication Center, preparing challenge-response data for AKA.
- **Identifier management:** Handling unique identifiers such as SUPI (Subscription Permanent Identifier, analogous to IMSI) and managing conversion to SUCI (Subscription Concealed Identifier) for privacy. UDM ensures the network can identify the subscriber securely and consistently across various NFs. It may also manage extended identifiers for IoT or vertical services, and support number portability data for routing.
- **Policy and service data provision:** Supplying subscription-related policy data to the **PCF** and session data to the **SMF**. For instance, if a user has a subscribed QoS profile or a default PDU session type, the UDM can provide that to the requesting NF. In slice selection, UDM informs the AMF about the user’s **Allowed NSSAI** (which slices they are permitted to use) during registration. It also indicates if the subscriber is barred from certain network areas or services (e.g., non-allowed areas).

_Interactions:_ The UDM offers its services via the **Nudm** API to other core functions. The **AMF** queries UDM (N8 interface) during the registration procedure to get the subscriber’s profile, which includes allowed slices and roaming restrictions. The **AUSF** connects to UDM (N13 interface) to fetch authentication vectors or to verify authentication responses. The **SMF** may use the UDM (N10) to retrieve session-specific subscription info, such as APN/DNN settings or static IP address assignments. The **PCF** can also access subscription data stored in the UDR/UDM (N15/N36) – for example, to get default policy rules for a subscriber’s plan. In addition, if an external application (via NEF) needs to query or update subscriber data (say, for device provisioning), the NEF would interface with UDM as permitted (Nudm exposure via NEF). Essentially, UDM is the authoritative source of “truth” for user data in the 5G Core. (It corresponds to the combined roles of **HSS** and part of **AAA server** from LTE/IMS, now split such that UDM covers data management and **AUSF** covers the authentication service.

## Authentication Server Function (AUSF)

The **AUSF** is dedicated to **authentication** in the 5G Core. Rather than having authentication logic embedded in a monolithic HSS as in 4G, 5G splits it out into this separate function. The AUSF works closely with UDM to perform the 5G-AKA (Authentication and Key Agreement) or EAP-based authentication for UEs. Its main roles include:

- **Authenticating UEs:** Validating the UE’s credentials by executing the authentication algorithms (e.g., MILENAGE or TUAK for 5G-AKA, or EAP methods) using the shared secret from the USIM (retrieved via UDM). When the AMF initiates an authentication procedure, AUSF generates an authentication challenge, and upon the UE’s response, AUSF verifies it to authenticate the subscriber.
- **Key agreement and security anchor:** Contributing to the generation of session keys and anchoring security for the session. The AUSF, together with the UDM’s key material, helps derive the anchor key that will be used by the AMF (and passed to the RAN) to secure subsequent communications. Essentially, it confirms the UE and network share the same key and then provides the AMF with the materials to set up NAS and AS (Access Stratum) encryption/integrity keys (through an intermediate function called SEAF – Security Anchor Function – which is collocated with the AMF).
- **Subscription authorization for services:** Indicating whether the subscriber is authorized for the requested service or network slice during the authentication procedure. For example, as part of the authentication/authorization step, AUSF (with UDM info) may affirm if the UE is allowed to attach to this network or use certain 5G features.
- **Support for roaming authentication:** In roaming scenarios, the visited network’s SEAF/AMF might reach out to the home network’s AUSF (via secure inter-operator links) to perform authentication. AUSF ensures that even when the user is roaming, the authentication is done against the home credentials.

_Interactions:_ The AUSF is triggered by the **AMF** during the registration or authentication refresh procedures (over the N12 interface). It communicates with the **UDM** (N13 interface) to get the authentication data (e.g., the Authentication Vector which contains RAND, AUTN, XRES, CK, IK for 5G-AKA. After successful authentication, the AUSF provides the AMF with a confirmation (and perhaps a key that the AMF uses to derive further keys). The AUSF doesn’t directly talk to the UE or RAN – all UE-facing auth signaling is relayed via the AMF (NAS messages). In the 5G SBA model, AUSF simply offers an authentication service that the AMF consumes. This clean separation means the AUSF can be scaled or upgraded (to support new EAP methods, for instance) independently. From a 4G perspective, the AUSF performs what the **HSS/AAA** did specifically for auth, but now as a standalone function. It enhances security by isolating authentication logic and allowing for flexible integration of third-party authentication schemes if needed (e.g., enterprise credentials via EAP).

## Policy Control Function (PCF)

The **PCF** is the policy brain of the 5G Core, analogous to the PCRF in 4G EPC. It provides a **unified policy framework** that governs network behavior, ensuring subscribers and services receive the appropriate QoS, bandwidth, and access as per business and network rules. The PCF’s key functions are:

- **Policy decision making:** Determining policy rules for network traffic and subscriber sessions, including QoS parameters, charging rules, and access control decision. When a new session is established or conditions change, the PCF decides what treatment that session should get (e.g., “UE is on a premium plan, allow up to X Mbps and low latency QoS”, or “apply video streaming optimization for this flow”). It essentially centralizes all policy logic.
- **Policy enforcement coordination:** Distributing those policy rules to the relevant control-plane functions like SMF (for session/QoS rules enforcement) and even AMF (for access-level policies). For instance, PCF provides the SMF with PCC (Policy and Charging Control) rules that specify allowed QoS flows, data rate limits, and charging credit for a PDU session. The SMF then enforces these via the UPF and RAN. PCF can also instruct the AMF to enforce certain access policies (like throttling signaling for a device, or blocking attach in certain conditions), though the typical data-path policies are handled at SMF/UPF.
- **Subscription-based policy provisioning:** Fetching and applying subscriber-specific policies based on their subscription profile stored in the UDM/UDR. For example, if a user has purchased an “enterprise SLA”, the PCF knows to apply stricter QoS guarantees for their traffic. The PCF can query a **UDR** for any stored policy profiles or data caps associated with that subscriber (using Nudr/N36 interface).
- **Dynamic policy adaptation (event exposure):** Adapting policies in real time based on network events or external triggers. The PCF can subscribe to events like UE location change, congestion status, or usage thresholds via the 5G Event Exposure framework. For instance, if a user exceeds a data quota, the PCF might adjust their QoS down or trigger a notification. It can also react to analytic inputs (e.g., from an NWDAF analytics function) to tweak policies for optimization.
- **Application influence and slice-specific policies:** Interacting with Application Functions (AFs) to apply **application-aware policies**, and ensuring policies are slice-aware. For instance, if a video streaming AF requests a certain QoS for a video flow, the PCF will factor that in. Similarly, if a network slice has particular policy requirements (like prioritizing low-latency traffic on a URLLC slice), the PCF maintains and applies distinct policy sets per slice to uphold the service level agreements of that slice.

_Interactions:_ The PCF primarily interfaces with other control-plane NFs via service-based interfaces. The **SMF** is a major consumer of PCF decisions – they communicate over the N7 reference point (Npcf_SMPolicy) where the SMF requests policy rules for a session and the PCF replies with those rules. The **AMF** can also interact with PCF (N15 in roaming scenarios or for access policies) to receive policies related to UE admission, mobility, or network slice access. The PCF pulls subscription policy information from the **UDR/UDM** (N36 or Nudm) as needed. For application-driven policy, the PCF interfaces with the **AF** either directly (N5 interface if the AF is trusted/internal) or via the **NEF** if the AF is an external third-party. PCF may also subscribe to event notifications from NEF or directly from NFs (for example, subscribe to UE location change from AMF, or data usage reports from SMF) using the service-based event exposure mechanisms. In 4G, the PCRF had similar roles, but in 5G the PCF is more flexible and unified across services (it isn’t split into “home” vs “visited” PCRF; a PCF can serve both local and roaming scenarios with coordination via N24 between visited and home PCFs if needed). The PCF is crucial for real-time control of network resources and enforcing operator-defined policy across the 5GC.

## Network Slice Selection Function (NSSF)

The **NSSF** is a new function in 5G whose sole purpose is to facilitate **network slicing** by guiding the core network on slice selection. **Network slicing** allows multiple logical networks to be carved out of the 5G infrastructure for different services or customers. NSSF helps ensure a device’s traffic is routed to the appropriate slice’s core network instances. Its main functions include:

- **Slice selection assistance:** Upon a UE’s registration or session request, the NSSF advises which **Network Slice Instance(s)** should serve that UE. The AMF sends the NSSF information about the UE (such as requested slice types, the subscriber’s allowed slice list from UDM, and possibly location or other context); the NSSF responds with an **Allowed NSSAI** (permitted slices for that UE in the current area) and may suggest mapping of the requested slice(s) to the available instance(s) in the network. For example, if a UE requests a slice for “vehicular communication”, NSSF might determine the specific slice instance (e.g., Slice ID 011-223) and even which set of network functions (AMF/SMF) handle that slice.
- **Slice instance availability and admission:** Keeping track of which slice instances are deployed and their status, and using that knowledge to direct requests appropriately. If a slice is congested or out of service, NSSF can avoid selecting it. It essentially acts as a database of operator-defined slices and their serving core nodes.
- **Enforcing operator policies for slicing:** Applying rules about how UEs are assigned to slices and how to prioritize slice access. For instance, if a subscriber is not allowed on a certain slice (perhaps that slice is reserved for enterprise users), the NSSF will ensure an alternative or default slice is chosen. Or if a slice has a maximum number of UEs, NSSF can limit assignments to it.
- **AMF set selection:** In some architectures, different AMF clusters might serve different slices. NSSF can determine if a UE needs to be redirected to a different AMF that serves the requested slice. In initial registration, if the current AMF cannot serve a particular slice needed by the UE, NSSF helps identify an AMF (or set of AMFs) that can. This allows the network to steer the UE to the right core network handling its services.

_Interactions:_ The **AMF** is the primary client of the NSSF. During the UE’s registration process, the AMF queries NSSF (N22 interface) providing the subscriber’s Temporary ID, requested NSSAI, and other context; NSSF returns the allowed slices for that UE and possibly the recommended core network handling for those slices. The AMF uses this information to restrict or grant slice access and to choose or redirect to appropriate **SMF(s)** for setting up PDU sessions on those slices. The NSSF may also interface with **UDM** indirectly – the AMF usually gets the subscriber’s slice permissions from UDM and supplies them to NSSF, but NSSF could be integrated with that data too. If network slices span multiple operators (roaming scenario), an NSSF might communicate with a counterpart via N31 to coordinate slice selection across networks. In essence, NSSF is like a directory of slices: it knows the landscape of slice deployment and ensures each UE is matched to the correct slice according to subscription and network policy. Without an equivalent in 4G, this function was introduced to meet the new slicing paradigm of 5G.

## NF Repository Function (NRF)

The **NRF** is another new component in 5G, enabling the **service-based architecture** by acting as a **network function registry and discovery service**. In a dynamic 5G core where NFs can scale in and out or be deployed in slices, the NRF keeps track of all NF instances and their capabilities. Its core functions:

- **NF Registration:** Allowing network functions to **register** themselves when they come online, providing their profile (NF type, supported services, capacities, addressing, etc.). For example, when an SMF instance starts, it registers with the NRF and includes information like “I am an SMF serving slice X in region Y, reachable at this API endpoint, supporting API version Z”.
- **Service Discovery:** Enabling NFs to **discover** other NFs’ services by query. When a network function (say AMF) needs to find an instance of another function (say an SMF that can handle a requested slice or DNN), it queries the NRF for available candidates that match certain criteria. NRF responds with the addresses/profiles of those NF instances so the requester can directly communicate with them. This eliminates the need for static provisioning of NF addresses and supports flexible scaling.
- **NF status monitoring:** Maintaining the status and availability of NF instances. NRF keeps an updated list; if an instance deregisters or fails, it will no longer be offered for discovery. Some implementations might have heartbeats or status subscription so that NRF knows in real-time which NFs are active. This helps the 5G core self-organize and route around failures.
- **Service authorization:** Optionally, NRF can enforce that only authorized NFs discover certain services (ensuring security within the service mesh). It holds NF instance certificates or tokens as part of profiles to facilitate secure communication establishment.

_Interactions:_ **All network functions that use the SBA** interact with NRF. On startup, each NF (AMF, SMF, PCF, etc.) **registers** with the NRF (Nnrf_Register) providing its NF profile. When an NF needs to call another, instead of using a fixed configured address, it queries the NRF (Nnrf_Discovery) to get a list of NF instances that meet its needs. For example, as part of a PDU session setup, an **AMF** might query NRF: “give me an SMF that serves DNN=internet and slice=SST1” and NRF returns the SMF’s API address. Or an **SMF** might query for a **PCF** serving a particular subscriber’s home PLMN. In a multi-slice environment, the NRF can be slice-specific or global, but generally there may be one logical NRF per operator network (or per slice, depending on deployment) that federates with others via N27 (for inter-PLMN NF discovery). By providing a directory of services, the NRF is fundamental to the flexible, plug-and-play nature of the 5G core. (There was no direct analogue in 4G EPC – NRF is a 5G innovation, though similar concepts existed in other systems or proprietary implementations.) It ensures that as the core network grows to dozens of microservices, they can all find each other and interoperate **dynamically**.

## Network Exposure Function (NEF)

The **NEF** serves as a secure gateway to **expose 5G Core capabilities** to external application services or third-party providers. It can be seen as the evolution of the 4G SCEF (Service Capability Exposure Function), providing a standardized way for external applications to interact with the core’s services and data without compromising security or integrity. Major aspects of NEF include:

- **API Gateway for external services:** Exposing APIs that allow external applications (or application functions that are not fully trusted by the operator) to request services from the 5G Core. This can include APIs to create or manage PDU sessions, to query or subscribe to user events (location, reachability), to request specific QoS for an application flow, etc. The NEF translates these high-level requests into the appropriate interactions with internal NFs. For example, an IoT platform could use an NEF API to request the network to “send a device-trigger message” to a UE – NEF would internally invoke an SMF or AMF service to deliver that downlink message.
- **Security, throttling, and policy enforcement for exposure:** Acting as a shield so that external queries do not overwhelm or misuse the core. NEF validates the identity and permissions of external AFs, ensures they are authorized to use the requested API (for example, a fleet management application can only query location for its own devices, not others), and throttles requests to protect core resources. It enforces any operator policies on what is exposed and how often.
- **Exposure of events and analytics:** Allowing external apps to **subscribe to network events** or data, in a controlled manner. For instance, a content provider’s application could subscribe (via NEF) to be notified when a particular user’s bandwidth drops below a threshold (to adapt video quality), or an IoT server could get alerts when one of its devices connects to the network. NEF can interface with internal analytics (e.g. NWDAF) or directly with NFs to gather this information and pass it on.
- **Mapping between external and internal information:** Translating non-3GPP mechanisms to 3GPP procedures and vice versa. For example, if an external API call asks to set a device’s “monitoring event”, the NEF will translate that into an appropriate subscription in AMF or SMF. Likewise, if an event occurs (say UE moves to a new cell), NEF can package that into a webhook or API callback to the external client in a format they understand. It also may store some of these subscriptions in a **UDR** (via Nudr/N37) as needed to keep state persistently.

_Interactions:_ The NEF sits at the boundary between the core network and external Application Functions (which could be third-party or even operator-owned application servers). External **AFs** communicate with NEF over exposed APIs (often RESTful JSON APIs) – in 3GPP terms, this is represented as the **N33** interface between NEF and AF. Internally, NEF has the ability to invoke services on other NFs: for example, it may use **N29** to request services from SMF (like triggering a session establishment or retrieving usage data), **N30** to talk to PCF (for policy requests on behalf of an AF), or **N8/Nudm** to retrieve data from UDM. Essentially, NEF can be a “proxy” calling the same APIs that an internal NF consumer would, but doing so on behalf of an external entity, with appropriate credentials. The NEF also interacts with the **UDR** to store the exposure data (like long-lived subscriptions or API invocation records. By centralizing external access, NEF ensures that the core’s internal APIs are not directly exposed one-by-one to outside, simplifying security and management. In 4G, a similar role was played by SCEF (exposing some services like device monitoring, non-IP data delivery, etc.), but NEF in 5G is more powerful and general.

## Application Function (AF)

In 5G Core, an **Application Function (AF)** represents an application-level entity that can interact with core network policies or exposure capabilities to **influence network behavior according to application needs**. An AF might be an operator’s own service (e.g., IMS for voice, or a video streaming service platform), or a third-party application server. While the AF itself is not a part of the core network per se, it is a **consumer** of certain core services (usually via PCF or NEF). Important points about AF:

- **Application-driven policy requests:** An AF can **request specific network behaviors** for the traffic of an application. For example, an IMS call control AF can signal to the PCF that a voice call flow for a certain UE should get a dedicated bearer with low latency. Similarly, a cloud gaming server could ask for high priority for gaming packets. The AF conveys such requests in the form of **Service Quality** or **Routing** information to the PCF, which then translates it into QoS rules via the SMF/UPF. This is known as application influence on traffic routing and QoS.
- **Utilizing network exposure:** AFs (especially third-party ones) might leverage the **NEF** to access capabilities like user status, location, analytics, etc.. For instance, a content provider’s AF might query NEF for user location to serve them content from the nearest cache. Or a public safety AF might use NEF to pre-emptively allocate network resources during an incident. The AF essentially uses the network as a service, via exposed APIs, to enhance application performance or awareness.
- **Edge application interaction:** In edge computing scenarios, an AF could be an application hosted at the edge that needs to interface with the core for local breakout or traffic steering. Through NEF/PCF, it could signal the core to keep certain traffic local.
- **End-to-end service logic:** AFs can also represent functionalities like **SMS over NAS service (SMSF)** or **CEF** for converged charging, which interact with the core for specific services. However, those are often considered separate NFs. Generally, when we say AF in policy context, we mean any application-level function interfacing with PCF/NEF. In the **5G-IMS** context, the P-CSCF or S-CSCF can act as an AF towards the PCF to request QoS for voice/video sessions.

_Interactions:_ An AF communicates with the **PCF** over the N5 interface if it is trusted by the operator (i.e., an internal AF). Through this, it can push policy requests or receive notifications (for example, PCF can inform the AF if a policy rule was applied or if a user’s conditions changed). If the AF is external (non-trusted), it will go through the **NEF** (which in turn interfaces with PCF, UDM, etc., on its behalf. The AF may also receive network event notifications: e.g., PCF (via NEF) could notify an AF that a user is now connected or has moved cells, if the AF subscribed to such events. In summary, the AF is not a core network function _defined_ by 3GPP in the same sense as others; rather, it’s an entity that **exploits core network functions** to align network behavior with application needs. In 4G, the concept existed similarly (e.g., an AF interfacing with PCRF for sponsored data or QoS; the classic example is an IMS application telling PCRF to prioritize VoLTE packets). In 5G, this continues, with even more flexibility via NEF and the service-based approach.
